import{r as o,U as G,j as e,R as C,x as T}from"./index-B8GXP3NQ.js";import"./js.cookie-Cz0CWeBA.js";import{F as a,R as f,C as p}from"./Row-D5t1_bNo.js";import{T as B}from"./Alert-BLiHCzkI.js";import{G as _,A as F,U as W}from"./Purchase_SubCategoriesApi-DrCg-vRr.js";import{G as R}from"./Purchase_CategoriesApi-DvrM_xKn.js";import{A as E}from"./SubBaseCategoriesApi-Da_R1pRA.js";import{B as h}from"./Button-OY5uUh63.js";const I={"Save-form-main":"_Save-form-main_840r9_2"};function V({id:s}){const[c,n]=o.useState(!0),i=o.useContext(G),[m,g]=o.useState([]),[u,d]=o.useState(1),[r,y]=o.useState({psCategoryID:"لا يوجد",subCategoryName:""});function S(t){y(l=>({...l,psCategoryID:s,subCategoryName:t.subCategoryName})),n(!1)}async function j(){const t=await R();g(t)}function x(){y(t=>({...t,psCategoryID:"لا يوجد",subCategoryName:""})),n(!0)}function P(t){y({...r,subCategoryName:t})}async function b(){const t=await _(s);t.status?x():S(t)}async function N(){console.log(r);const t={subCategoryName:r.subCategoryName,createdByUserID:i.userInfo.UserID},l=await F(t);console.log(l);const A={psCategoryID:l.psCategoryID,pCategoryID:u,userID:i.userInfo.UserID};return await E(A),window.location.hash=`/home/PSCategory/${l.psCategoryID}`,!0}async function w(){const t={psCategoryID:s,subCategoryName:r.subCategoryName,updatedByUserID:i.userInfo.UserID};return await W(t,r.psCategoryID),!0}o.useEffect(()=>{x(),s!=0&&b()},[s]),o.useEffect(()=>{j()},[]);async function D(){return await U()!=!0?!1:c?!!await N():!!await w()}function v(t){d(t.target.value)}async function U(){return r.subCategoryName.trim()!=""}return e.jsxs(e.Fragment,{children:[e.jsxs(a,{className:I["Save-form-main"],children:[e.jsxs(a.Group,{as:f,controlId:"formPlaintextStoreID",children:[e.jsx(a.Label,{column:!0,sm:"2",style:{minWidth:"150px"},children:"رقم الصنف :"}),e.jsx(p,{sm:"3",children:e.jsx(a.Control,{sm:"2",value:r.psCategoryID,plaintext:!0,readOnly:!0,defaultValue:"لا يوجد"})})]}),c&&e.jsxs(a.Group,{as:f,style:{marginTop:"50px",marginBottom:"25px"},controlId:"formSelectPurchaseCategories",onChange:v,children:[e.jsx(a.Label,{column:!0,sm:"2",style:{minWidth:"150px"},children:"الصنف الرئيسية"}),e.jsx(p,{sm:"3",children:e.jsx(a.Select,{"aria-label":"select Purchase Type",value:u,style:{minWidth:"250px"},onChange:t=>d(t.target.value),children:m.map(t=>e.jsx("option",{value:t.PCategoryID,children:t.CategoryName},t.PCategoryID))})})]}),e.jsxs(a.Group,{as:f,style:{marginTop:"50px",marginBottom:"25px"},controlId:"formPlaintextStoreName",children:[e.jsx(a.Label,{column:!0,sm:"2",style:{minWidth:"150px"},children:"اسم الصنف :"}),e.jsx(p,{sm:"3",children:e.jsx(a.Control,{value:r.subCategoryName,onChange:t=>P(t.target.value),sm:"2",type:"text",placeholder:"اسم الصنف",style:{minWidth:"250px"}})})]})]}),e.jsx(L,{SaveOpreation:D})]})}function L({SaveOpreation:s}){const[c,n]=C.useState(!1),[i,m]=C.useState(""),[g,u]=C.useState("");return e.jsxs(e.Fragment,{children:[e.jsx(a,{className:I["Save-form-main"],children:e.jsxs("div",{children:[e.jsx(h,{variant:"outlined",style:{minWidth:"150px",margin:"25px"},children:"الغاء"}),e.jsx(h,{variant:"contained",style:{minWidth:"150px",margin:"25px"},onClick:async()=>{await s()?(m("success"),u("تمت العملية بنجاح")):(m("error"),u("فشلت العملية")),n(!0)},children:"حفظ"})]})}),e.jsx(B,{open:c,setOpen:n,Message:g,severityType:i})]})}const K=()=>{const{id:s}=T();return e.jsx(e.Fragment,{children:e.jsx(V,{id:s})})};export{K as default};
