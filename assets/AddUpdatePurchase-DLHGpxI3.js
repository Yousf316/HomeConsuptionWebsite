import{j as t,v as ue,r as c,P as b,w as me,k as de}from"./index-Ck1YdO2d.js";import{a as L}from"./js.cookie-Cz0CWeBA.js";import{r as pe,i as fe,f as he,M as xe,g as q,h as P,j as K,k as Q,B as je,l as z,I as H,m as ye,n as ge}from"./index.esm-DHsAc19C.js";import"./DefaultLayout-DT50Su1p.js";import"./index.es-DnGR0Tlg.js";import"./cil-user-Ddrdy7PS.js";var _={},Ce=fe;Object.defineProperty(_,"__esModule",{value:!0});var W=_.default=void 0,Te=Ce(pe()),Ne=t;W=_.default=(0,Te.default)((0,Ne.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var X={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var o={}.hasOwnProperty;function n(){for(var r="",i=0;i<arguments.length;i++){var m=arguments[i];m&&(r=a(r,s(m)))}return r}function s(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return n.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var i="";for(var m in r)o.call(r,m)&&r[m]&&(i=a(i,m));return i}function a(r,i){return i?r?r+" "+i:r+i:r}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(X);var we=X.exports;const j=ue(we),Ie=["xxl","xl","lg","md","sm","xs"],Fe="xs",A=c.createContext({prefixes:{},breakpoints:Ie,minBreakpoint:Fe});function T(e,o){const{prefixes:n}=c.useContext(A);return e||n[o]||o}function Y(){const{breakpoints:e}=c.useContext(A);return e}function Z(){const{minBreakpoint:e}=c.useContext(A);return e}function ve({as:e,bsPrefix:o,className:n,...s}){o=T(o,"col");const a=Y(),r=Z(),i=[],m=[];return a.forEach(x=>{const p=s[x];delete s[x];let h,g,y;typeof p=="object"&&p!=null?{span:h,offset:g,order:y}=p:h=p;const l=x!==r?`-${x}`:"";h&&i.push(h===!0?`${o}${l}`:`${o}${l}-${h}`),y!=null&&m.push(`order${l}-${y}`),g!=null&&m.push(`offset${l}-${g}`)}),[{...s,className:j(n,...i,...m)},{as:e,bsPrefix:o,spans:i}]}const w=c.forwardRef((e,o)=>{const[{className:n,...s},{as:a="div",bsPrefix:r,spans:i}]=ve(e);return t.jsx(a,{...s,ref:o,className:j(n,!i.length&&r)})});w.displayName="Col";const be={type:b.string,tooltip:b.bool,as:b.elementType},B=c.forwardRef(({as:e="div",className:o,type:n="valid",tooltip:s=!1,...a},r)=>t.jsx(e,{...a,ref:r,className:j(o,`${n}-${s?"tooltip":"feedback"}`)}));B.displayName="Feedback";B.propTypes=be;const I=c.createContext({}),O=c.forwardRef(({id:e,bsPrefix:o,className:n,type:s="checkbox",isValid:a=!1,isInvalid:r=!1,as:i="input",...m},x)=>{const{controlId:p}=c.useContext(I);return o=T(o,"form-check-input"),t.jsx(i,{...m,ref:x,type:s,id:e||p,className:j(n,o,a&&"is-valid",r&&"is-invalid")})});O.displayName="FormCheckInput";const $=c.forwardRef(({bsPrefix:e,className:o,htmlFor:n,...s},a)=>{const{controlId:r}=c.useContext(I);return e=T(e,"form-check-label"),t.jsx("label",{...s,ref:a,htmlFor:n||r,className:j(o,e)})});$.displayName="FormCheckLabel";function Re(e,o){return c.Children.toArray(e).some(n=>c.isValidElement(n)&&n.type===o)}const ee=c.forwardRef(({id:e,bsPrefix:o,bsSwitchPrefix:n,inline:s=!1,reverse:a=!1,disabled:r=!1,isValid:i=!1,isInvalid:m=!1,feedbackTooltip:x=!1,feedback:p,feedbackType:h,className:g,style:y,title:l="",type:u="checkbox",label:d,children:C,as:v="input",...S},k)=>{o=T(o,"form-check"),n=T(n,"form-switch");const{controlId:N}=c.useContext(I),E=c.useMemo(()=>({controlId:e||N}),[N,e]),V=!C&&d!=null&&d!==!1||Re(C,$),ie=t.jsx(O,{...S,type:u==="switch"?"checkbox":u,ref:k,isValid:i,isInvalid:m,disabled:r,as:v});return t.jsx(I.Provider,{value:E,children:t.jsx("div",{style:y,className:j(g,V&&o,s&&`${o}-inline`,a&&`${o}-reverse`,u==="switch"&&n),children:C||t.jsxs(t.Fragment,{children:[ie,V&&t.jsx($,{title:l,children:d}),p&&t.jsx(B,{type:h,tooltip:x,children:p})]})})})});ee.displayName="FormCheck";const D=Object.assign(ee,{Input:O,Label:$}),te=c.forwardRef(({bsPrefix:e,type:o,size:n,htmlSize:s,id:a,className:r,isValid:i=!1,isInvalid:m=!1,plaintext:x,readOnly:p,as:h="input",...g},y)=>{const{controlId:l}=c.useContext(I);return e=T(e,"form-control"),t.jsx(h,{...g,type:o,size:s,ref:y,readOnly:p,id:a||l,className:j(r,x?`${e}-plaintext`:e,n&&`${e}-${n}`,o==="color"&&`${e}-color`,i&&"is-valid",m&&"is-invalid")})});te.displayName="FormControl";const Se=Object.assign(te,{Feedback:B}),oe=c.forwardRef(({className:e,bsPrefix:o,as:n="div",...s},a)=>(o=T(o,"form-floating"),t.jsx(n,{ref:a,className:j(e,o),...s})));oe.displayName="FormFloating";const G=c.forwardRef(({controlId:e,as:o="div",...n},s)=>{const a=c.useMemo(()=>({controlId:e}),[e]);return t.jsx(I.Provider,{value:a,children:t.jsx(o,{...n,ref:s})})});G.displayName="FormGroup";const se=c.forwardRef(({as:e="label",bsPrefix:o,column:n=!1,visuallyHidden:s=!1,className:a,htmlFor:r,...i},m)=>{const{controlId:x}=c.useContext(I);o=T(o,"form-label");let p="col-form-label";typeof n=="string"&&(p=`${p} ${p}-${n}`);const h=j(a,o,s&&"visually-hidden",n&&p);return r=r||x,n?t.jsx(w,{ref:m,as:"label",className:h,htmlFor:r,...i}):t.jsx(e,{ref:m,className:h,htmlFor:r,...i})});se.displayName="FormLabel";const ne=c.forwardRef(({bsPrefix:e,className:o,id:n,...s},a)=>{const{controlId:r}=c.useContext(I);return e=T(e,"form-range"),t.jsx("input",{...s,type:"range",ref:a,className:j(o,e),id:n||r})});ne.displayName="FormRange";const re=c.forwardRef(({bsPrefix:e,size:o,htmlSize:n,className:s,isValid:a=!1,isInvalid:r=!1,id:i,...m},x)=>{const{controlId:p}=c.useContext(I);return e=T(e,"form-select"),t.jsx("select",{...m,size:n,ref:x,className:j(s,e,o&&`${e}-${o}`,a&&"is-valid",r&&"is-invalid"),id:i||p})});re.displayName="FormSelect";const ae=c.forwardRef(({bsPrefix:e,className:o,as:n="small",muted:s,...a},r)=>(e=T(e,"form-text"),t.jsx(n,{...a,ref:r,className:j(o,e,s&&"text-muted")})));ae.displayName="FormText";const le=c.forwardRef((e,o)=>t.jsx(D,{...e,ref:o,type:"switch"}));le.displayName="Switch";const $e=Object.assign(le,{Input:D.Input,Label:D.Label}),ce=c.forwardRef(({bsPrefix:e,className:o,children:n,controlId:s,label:a,...r},i)=>(e=T(e,"form-floating"),t.jsxs(G,{ref:i,className:j(o,e),controlId:s,...r,children:[n,t.jsx("label",{htmlFor:s,children:a})]})));ce.displayName="FloatingLabel";const De={_ref:b.any,validated:b.bool,as:b.elementType},M=c.forwardRef(({className:e,validated:o,as:n="form",...s},a)=>t.jsx(n,{...s,ref:a,className:j(e,o&&"was-validated")}));M.displayName="Form";M.propTypes=De;const f=Object.assign(M,{Group:G,Control:Se,Floating:oe,Check:D,Switch:$e,Label:se,Text:ae,Range:ne,Select:re,FloatingLabel:ce}),F=c.forwardRef(({bsPrefix:e,className:o,as:n="div",...s},a)=>{const r=T(e,"row"),i=Y(),m=Z(),x=`${r}-cols`,p=[];return i.forEach(h=>{const g=s[h];delete s[h];let y;g!=null&&typeof g=="object"?{cols:y}=g:y=g;const l=h!==m?`-${h}`:"";y!=null&&p.push(`${x}${l}-${y}`)}),t.jsx(n,{ref:a,...s,className:j(o,r,...p)})});F.displayName="Row";const R={"Total-form":"_Total-form_16mn1_1","Total-form-main":"_Total-form-main_16mn1_5"};function Be(){function e(s){console.log(s.target.value),console.log(document.getElementById("formSelectSores").value)}c.useState(1);const[o,n]=c.useState([]);return c.useEffect(()=>{async function s(){const a=await Ee();n(a)}s()},[]),t.jsxs(f,{children:[t.jsxs(f.Group,{as:F,className:"mb-3",controlId:"formPlaintextPurchaseID",children:[t.jsx(f.Label,{column:!0,sm:"2",children:"رقم الفاتورة"}),t.jsx(w,{sm:"10",children:t.jsx(f.Control,{plaintext:!0,readOnly:!0,defaultValue:"لا يوجد"})})]}),t.jsxs(f.Group,{as:F,className:"mb-3",controlId:"formSelectPurchaseType",children:[t.jsx(f.Label,{column:!0,sm:"2",children:"نوع الفاتورة"}),t.jsx(w,{sm:"10",children:t.jsxs(f.Select,{"aria-label":"select Purchase Type",onChange:s=>e(s),children:[t.jsx("option",{value:"1",children:"سريعة"}),t.jsx("option",{value:"2",children:"عادية"})]})})]}),t.jsxs(f.Group,{as:F,className:"mb-3",controlId:"formSelectSores",children:[t.jsx(f.Label,{column:!0,sm:"2",children:"المتجر"}),t.jsx(w,{sm:"10",children:t.jsx(f.Select,{"aria-label":"select Purchase Type",onChange:s=>e(s),children:o.map(s=>t.jsx("option",{value:s.StoreID,children:s.StoreName},s.StoreID))})})]})]})}function ke(){function e(o){console.log(o.target.value);const n=document.getElementById("formInputTotalAfterDiscount"),s=document.getElementById("formInputTotal");console.log(n.value),n.value=s.value-o.target.value}return t.jsxs(f,{className:R["Total-form-main"],children:[t.jsxs(f.Group,{as:F,className:R["Total-form"],controlId:"formInputTotal",children:[t.jsx(f.Label,{column:!0,sm:"1",children:"المجموع"}),t.jsx(w,{sm:"5",children:t.jsx(f.Control,{type:"number",readOnly:!0,defaultValue:0})})]}),t.jsxs(f.Group,{as:F,className:R["Total-form"],controlId:"formInputDiscount",children:[t.jsx(f.Label,{column:!0,sm:"1",children:"الخصم"}),t.jsx(w,{sm:"5",children:t.jsx(f.Control,{type:"number",defaultValue:0,onChange:o=>e(o)})})]}),t.jsxs(f.Group,{as:F,className:R["Total-form"],controlId:"formInputTotalAfterDiscount",children:[t.jsx(f.Label,{column:!0,sm:"1",children:"الاجمالي بعد الخصم"}),t.jsx(w,{sm:"5",children:t.jsx(f.Control,{type:"number",defaultValue:0,readOnly:!0})})]}),t.jsxs(f.Group,{as:F,className:R["Total-form"],controlId:"formInputTax",children:[t.jsx(f.Label,{column:!0,sm:"1",children:"الضريبة"}),t.jsx(w,{sm:"5",children:t.jsx(f.Control,{type:"number",readOnly:!0,defaultValue:0})})]})]})}async function Ee(){const e=L.get("LOGIN_Info");let o=null;return await fetch("//www.homecproject.somee.com/api/Stores/GetStores",{headers:{Authorization:"Bearer "+e,"Content-type":"application/json"}}).then(n=>n.json()).then(n=>{o=n}).catch(n=>console.error("Fetch error:",n)),o}const Pe=()=>{const[e,o]=c.useState({}),n=c.useMemo(()=>[{accessorKey:"Total",header:"المجموع",enableEditing:!1},{accessorKey:"PricePerItem",header:"السعر",required:!0},{accessorKey:"Quantity",header:"الكمية",muiEditTextFieldProps:{required:!0,error:!!(e!=null&&e.firstName),helperText:e==null?void 0:e.firstName,onFocus:()=>o({...e,Quantity:void 0})}},{accessorKey:"description",header:"الوصف",muiEditTextFieldProps:{required:!0,error:!!(e!=null&&e.description),helperText:e==null?void 0:e.description,onFocus:()=>o({...e,description:void 0})}},{accessorKey:"itemName",header:"اسم المنتج",muiEditTextFieldProps:{required:!0,error:!!(e!=null&&e.itemName),helperText:e==null?void 0:e.itemName,onFocus:()=>o({...e,itemName:void 0})}},{accessorKey:"id",header:"رقم المنتج",muiEditTextFieldProps:{error:!!(e!=null&&e.id),helperText:e==null?void 0:e.id}},{accessorKey:"sort",header:"#",enableEditing:!1,muiEditTextFieldProps:{error:!!(e!=null&&e.sort),helperText:e==null?void 0:e.sort}}],[e]),[s,a]=c.useState([]),{id:r}=me();c.useEffect(()=>{if(r!=0){async function l(){const u=await Le(r);console.log(u),document.getElementById("formPlaintextPurchaseID").value=u.purchaseID,document.getElementById("formSelectPurchaseType").value=u.type,document.getElementById("formInputTotalAfterDiscount").value=u.totalBeforTax;const d=document.getElementById("formSelectSores");d.value=u.storeID,document.getElementById("formInputTotal").value=u.totalBeforTax;const C=document.getElementById("formInputTax");C.value=u.taxAmount,console.log(C);const v=new InputEvent("input",{bubbles:!0,cancelable:!0});if(console.log(v),C.dispatchEvent(v),u.type==2){const S=await _e(r);console.log(S);const k=S.map((N,E)=>({key:E,id:String(N.itemID),itemName:N.itemName,description:N.description,Quantity:N.quantity,PricePerItem:N.itemPrice,sort:N.p_subID,Total:N.totalAmount}));a(k)}}l()}},[r]);const i=async({values:l,table:u})=>{const d=J(l);if(Object.values(d).some(C=>C)){o(d);return}o({}),await p(l),u.setCreatingRow(null)},m=async({values:l,table:u})=>{const d=J(l);if(Object.values(d).some(C=>C)){o(d);return}o({}),await h(l),u.setEditingRow(null)},x=l=>{window.confirm("Are you sure you want to delete this user?")&&(a(u=>u.filter(d=>d.sort!=l.original.sort)),a(u=>{let d=1;return u.map(C=>{const v={...C,sort:d};return d++,v})}))};function p(l){l.sort=s.length+1,l.Total=Number(l.PricePerItem)*Number(l.Quantity),a(u=>[...u,{...l}])}function h(l){a(u=>u.map(d=>d.sort===l.sort?{...d,...l}:d))}c.useContext(de).color;const y=he({columns:n,data:s,createDisplayMode:"modal",editDisplayMode:"modal",enableEditing:!0,onCreatingRowSave:i,onEditingRowSave:m,onCreatingRowCancel:()=>o({}),onEditingRowCancel:()=>o({}),renderCreateRowDialogContent:({table:l,row:u,internalEditComponents:d})=>t.jsxs(t.Fragment,{children:[t.jsx(q,{variant:"h3",children:"أدراج بند"}),t.jsxs(P,{sx:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d," "]}),t.jsx(K,{children:t.jsx(Q,{variant:"text",table:l,row:u})})]}),renderEditRowDialogContent:({table:l,row:u,internalEditComponents:d})=>t.jsxs(t.Fragment,{children:[t.jsx(q,{variant:"h3",children:"Edit User"}),t.jsxs(P,{sx:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[d," "]}),t.jsx(K,{children:t.jsx(Q,{variant:"text",table:l,row:u})})]}),renderRowActions:({row:l,table:u})=>t.jsxs(je,{sx:{display:"flex",gap:"1rem"},children:[t.jsx(z,{title:"تعديل",children:t.jsx(H,{onClick:()=>u.setEditingRow(l),children:t.jsx(ye,{})})}),t.jsx(z,{title:"حذف",children:t.jsx(H,{color:"error",onClick:()=>x(l),children:t.jsx(W,{})})})]}),renderTopToolbarCustomActions:({table:l})=>t.jsx(ge,{variant:"contained",onClick:()=>{l.setCreatingRow(!0)},children:"أدراج بند"}),muiTableHeadCellProps:{sx:l=>({color:l.palette.text.secondary})}});return t.jsxs(t.Fragment,{children:[t.jsx(Be,{}),t.jsx(xe,{table:y}),t.jsx(ke,{})]})},U=e=>!!e.length;function J(e){return{Quantity:U(e.Quantity)?"":"Quantity is Required",itemName:U(e.Quantity)?"":"itemName is Required"}}async function Le(e){const o=L.get("LOGIN_Info");let n=null;return await fetch(`//www.homecproject.somee.com/api/Purchase/${e}`,{headers:{Authorization:"Bearer "+o,"Content-type":"application/json"}}).then(s=>s.json()).then(s=>{n=s}).catch(s=>console.error("Fetch error:",s)),n}async function _e(e){const o=L.get("LOGIN_Info");let n=null;return await fetch(`//www.homecproject.somee.com/api/PurchaseSub/${e}`,{headers:{Authorization:"Bearer "+o,"Content-type":"application/json"}}).then(s=>s.json()).then(s=>{n=s}).catch(s=>console.error("Fetch error:",s)),n}export{_e as GetPurchaseSubInfo,Le as GetPurchasesInfo,Pe as default};
